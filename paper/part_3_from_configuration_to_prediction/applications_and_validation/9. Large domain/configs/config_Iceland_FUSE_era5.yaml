### ============================================= SYMFLUENCE configuration file ============================================================
# FUSE Model Configuration for Full Iceland Domain - Large Domain Study
### ============================================= 1. Global settings: =====================================================================

# Main paths
SYMFLUENCE_DATA_DIR: "/Users/darrieythorsson/compHydro/code/SYMFLUENCE_data/"
SYMFLUENCE_CODE_DIR: "/Users/darrieythorsson/compHydro/code/SYMFLUENCE"

# Experiment settings
DOMAIN_NAME: Iceland_Multivar
EXPERIMENT_ID: large_domain
EXPERIMENT_TIME_START: 2008-01-01 01:00
EXPERIMENT_TIME_END: 2010-12-31 23:00
CALIBRATION_PERIOD: 2009-01-01, 2009-12-31
EVALUATION_PERIOD: 2010-01-01, 2010-12-31
SPINUP_PERIOD: 2008-01-01, 2008-12-31

# Computational settings
MPI_PROCESSES: 1
FORCE_RUN_ALL_STEPS: False
USE_LOCAL_SCRATCH: false
LOG_LEVEL: INFO
LOG_TO_FILE: true
LOG_FORMAT: detailed

### ============================================= 2. Geospatial settings: =================================================================

# Coordinate settings
POUR_POINT_COORDS: 64.01/-16.01
BOUNDING_BOX_COORDS: 66.5/-25.0/63.0/-13.0

# Domain representation settings
DOMAIN_DEFINITION_METHOD: delineate
ROUTING_DELINEATION: distributed

GEOFABRIC_TYPE: na
DELINEATION_METHOD: stream_threshold
STREAM_THRESHOLD: 2000
LUMPED_WATERSHED_METHOD: TauDEM
CLEANUP_INTERMEDIATE_FILES: false
DELINEATE_COASTAL_WATERSHEDS: true
DELINEATE_BY_POURPOINT: false
MOVE_OUTLETS_MAX_DISTANCE: 200
MIN_GRU_SIZE: 0

# Domain discretization settings
DOMAIN_DISCRETIZATION: GRUs
ELEVATION_BAND_SIZE: 200
MIN_HRU_SIZE: 4
RADIATION_CLASS_NUMBER: 5
ASPECT_CLASS_NUMBER: 8
ASPECT_PATH: default

# DEM source
DEM_SOURCE: copernicus

# Shapefile settings - Catchment shape
CATCHMENT_PATH: default
CATCHMENT_SHP_NAME: default
CATCHMENT_SHP_LAT: center_lat
CATCHMENT_SHP_LON: center_lon
CATCHMENT_SHP_AREA: HRU_area
CATCHMENT_SHP_HRUID: HRU_ID
CATCHMENT_SHP_GRUID: GRU_ID

# Shapefile settings - Basins shape
RIVER_BASINS_PATH: default
RIVER_BASINS_NAME: default
RIVER_BASIN_SHP_RM_GRUID: GRU_ID
RIVER_BASIN_SHP_HRU_TO_SEG: gru_to_seg
RIVER_BASIN_SHP_AREA: GRU_area

# Shapefile settings - River network shape
RIVER_NETWORK_SHP_PATH: default
RIVER_NETWORK_SHP_NAME: default
RIVER_NETWORK_SHP_LENGTH: Length
RIVER_NETWORK_SHP_SEGID: LINKNO
RIVER_NETWORK_SHP_DOWNSEGID: DSLINKNO
RIVER_NETWORK_SHP_SLOPE: Slope

# Shapefile settings - Pour point
POUR_POINT_SHP_PATH: default
POUR_POINT_SHP_NAME: default

# Geospatial data paths
OUTPUT_BASINS_PATH: default
OUTPUT_RIVERS_PATH: default
DEM_PATH: default
DEM_NAME: default
SOURCE_GEOFABRIC_BASINS_PATH: default
SOURCE_GEOFABRIC_RIVERS_PATH: default
TAUDEM_DIR: default
OUTPUT_DIR: default
CATCHMENT_PLOT_DIR: default
SOIL_CLASS_PATH: default
SOIL_CLASS_NAME: default
LAND_CLASS_PATH: default
LAND_CLASS_NAME: default
RADIATION_PATH: default

# Tool paths
DATATOOL_PATH: default
GISTOOL_PATH: default
EASYMORE_CLIENT: easymore cli
DATATOOL_DATASET_ROOT: default
GISTOOL_DATASET_ROOT: default
TOOL_CACHE: default
EASYMORE_CACHE: default
EASYMORE_JOB_CONF: default
GISTOOL_LIB_PATH: default

### ============================================= 3. Model Agnostic settings: =============================================================

# Forcing data settings
DATA_ACCESS: cloud
FORCING_DATASET: ERA5
FORCING_VARIABLES: default
FORCING_MEASUREMENT_HEIGHT: 2
FORCING_TIME_STEP_SIZE: 3600
APPLY_LAPSE_RATE: True
LAPSE_RATE: 0.0065
FORCING_SHAPE_LAT_NAME: lat
FORCING_SHAPE_LON_NAME: lon
FORCING_PATH: default
PET_METHOD: oudin

# EM-Earth forcing supplementation settings
SUPPLEMENT_FORCING: False

# Intersection paths
INTERSECT_SOIL_PATH: default
INTERSECT_SOIL_NAME: default
INTERSECT_ROUTING_PATH: default
INTERSECT_ROUTING_NAME: default
INTERSECT_DEM_PATH: default
INTERSECT_DEM_NAME: default
INTERSECT_LAND_PATH: default
INTERSECT_LAND_NAME: default

### ============================================= 4. Model Specific settings: =============================================================

# Model settings
HYDROLOGICAL_MODEL: FUSE
ROUTING_MODEL: mizuRoute

# FUSE Model settings
FUSE_SPATIAL_MODE: distributed
FUSE_EXE: fuse.exe
FUSE_INSTALL_PATH: default
FUSE_ROUTING_INTEGRATION: default
SETTINGS_FUSE_PATH: default
SETTINGS_FUSE_FILEMANAGER: default
FUSE_RUN_INTERNAL_CALIBRATION: True
EXPERIMENT_OUTPUT_FUSE: default

# FUSE Parameters to calibrate
SETTINGS_FUSE_PARAMS_TO_CALIBRATE: MAXWATR_1,MAXWATR_2,BASERTE,QB_POWR,TIMEDELAY,PERCRTE,FRACTEN,RTFRAC1,MBASE,MFMAX,MFMIN,PXTEMP,LAPSE

# FUSE Decision options
FUSE_DECISION_OPTIONS:
  RFERR:
  - additive_e
  - multiplc_e
  ARCH1:
  - tension1_1
  ARCH2:
  - tens2pll_2
  QSURF:
  - arno_x_vic
  - prms_varnt
  QPERC:
  - perc_f2sat
  ESOIL:
  - sequential
  QINTF:
  - intflwnone
  Q_TDH:
  - rout_gamma
  SNOWM:
  - temp_index

# mizuRoute settings
SETTINGS_MIZU_WITHIN_BASIN: 0
SETTINGS_MIZU_ROUTING_DT: 3600
SETTINGS_MIZU_ROUTING_UNITS: m/s
SETTINGS_MIZU_ROUTING_VAR: averageRoutedRunoff
SETTINGS_MIZU_OUTPUT_FREQ: single
SETTINGS_MIZU_OUTPUT_VARS: 1
SETTINGS_MIZU_MAKE_OUTLET: n/a
SETTINGS_MIZU_NEEDS_REMAP: false
MIZU_FROM_MODEL: default
SETTINGS_MIZU_PATH: default
MIZUROUTE_INSTALL_PATH: default
MIZUROUTE_EXE: mizuRoute.exe
SETTINGS_MIZU_TOPOLOGY: topology.nc
SETTINGS_MIZU_PARAMETERS: param.nml.default
SETTINGS_MIZU_CONTROL_FILE: mizuroute.control
SETTINGS_MIZU_REMAP: routing_remap.nc

### ============================================= 5. Evaluation settings: =================================================================

# Simulation settings
# SIM_REACH_ID: default  # Optional int; omit to auto-detect
SIMULATIONS_PATH: default

# Observation data settings
OBSERVATIONS_PATH: default
EVALUATION_DATA:
- streamflow
ANALYSES:
- benchmarking
- attributes

# Observation data
STREAMFLOW_DATA_PROVIDER: IMO
DOWNLOAD_WSC_DATA: false
DOWNLOAD_USGS_DATA: false
STATION_ID: default
STREAMFLOW_RAW_PATH: default
STREAMFLOW_RAW_NAME: default
STREAMFLOW_PROCESSED_PATH: default

### ============================================= 6. Optimization settings: ===============================================================

OPTIMIZATION_METHODS: [iteration]
OPTIMIZATION_TARGET: streamflow
CALIBRATION_TIMESTEP: daily

# Iterative optimization settings
ITERATIVE_OPTIMIZATION_ALGORITHM: DDS
NUMBER_OF_ITERATIONS: 1000
DDS_R: 0.2
OPTIMIZATION_METRIC: KGE
TARGET_METRIC: KGE

# FUSE parameter bounds
FUSE_PARAM_BOUNDS:
  MAXWATR_1: [50, 500]
  MAXWATR_2: [50, 1000]
  BASERTE: [0.001, 0.5]
  QB_POWR: [1.0, 5.0]
  TIMEDELAY: [0.5, 5.0]
  PERCRTE: [0.01, 10.0]
  FRACTEN: [0.1, 0.7]
  RTFRAC1: [0.1, 0.9]
  MBASE: [-2.0, 2.0]
  MFMAX: [1.0, 8.0]
  MFMIN: [0.5, 4.0]
  PXTEMP: [-2.0, 4.0]
  LAPSE: [-8.0, -4.0]

# DDS specific settings
ASYNC_DDS_POOL_SIZE: 10
ASYNC_DDS_BATCH_SIZE: 10
MAX_STAGNATION_BATCHES: 5
